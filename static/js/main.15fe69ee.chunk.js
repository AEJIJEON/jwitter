(this.webpackJsonpjwitter=this.webpackJsonpjwitter||[]).push([[0],{39:function(e,t,n){},40:function(e,t,n){},41:function(e,t,n){},46:function(e,t,n){},47:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),c=n(27),u=n.n(c),o=n(5),i=n(17),l=n(6),s=n(4),m=n.n(s),d=n(9),p=n(18);n(36),n(48),n(49);p.a.initializeApp({apiKey:"AIzaSyBs1zwm1iM_D_uuc7lCtih8eg1vlxzQoFE",authDomain:"jwitter-c70dd.firebaseapp.com",projectId:"jwitter-c70dd",storageBucket:"jwitter-c70dd.appspot.com",messagingSenderId:"290377480338",appId:"1:290377480338:web:bfc2725420fd2195de0e4b"});var f=p.a,h=p.a.auth(),b=p.a.firestore(),E=p.a.storage(),v=function(){var e=Object(a.useState)(""),t=Object(o.a)(e,2),n=t[0],c=t[1],u=Object(a.useState)(""),i=Object(o.a)(u,2),l=i[0],s=i[1],p=Object(a.useState)(!0),f=Object(o.a)(p,2),E=f[0],v=f[1],g=Object(a.useState)(""),w=Object(o.a)(g,2),j=w[0],O=w[1],x=function(e){var t=e.target,n=t.name,a=t.value;"email"===n?c(a):"password"===n&&s(a)},y=function(){var e=Object(d.a)(m.a.mark((function e(t){var a,r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),e.prev=1,!E){e.next=11;break}return e.next=5,h.createUserWithEmailAndPassword(n,l);case 5:return a=e.sent,r={uid:a.user.uid,photoUrl:"",displayName:"not set"},e.next=9,b.collection("userInfos").add(r);case 9:e.next=14;break;case 11:return e.next=13,h.signInWithEmailAndPassword(n,l);case 13:a=e.sent;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(1),O(e.t0.message);case 19:case"end":return e.stop()}}),e,null,[[1,16]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,r.a.createElement("form",{onSubmit:y},r.a.createElement("input",{name:"email",type:"email",placeholder:"Email",required:!0,value:n,onChange:x}),r.a.createElement("input",{name:"password",type:"password",placeholder:"Password",required:!0,value:l,onChange:x}),r.a.createElement("input",{type:"submit",value:E?"Create Account":"Sign In"}),j),r.a.createElement("span",{onClick:function(){return v((function(e){return!e}))}},E?"Sign In":"Create Account"))},g=function(){var e=function(){var e=Object(d.a)(m.a.mark((function e(t){var n,a,r,c,u;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"google"===(n=t.target.name)?a=new f.auth.GoogleAuthProvider:"github"===n&&(a=new f.auth.GithubAuthProvider),e.next=4,h.signInWithPopup(a);case 4:return r=e.sent,u=!0,e.next=8,b.collection("userInfos").get();case 8:if(e.sent.docs.forEach((function(e){e.data().uid===r.user.uid&&(u=!1)})),!u){e.next=14;break}return c={uid:r.user.uid,photoUrl:"",displayName:"not set"},e.next=14,b.collection("userInfos").add(c);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",null,r.a.createElement(v,null),r.a.createElement("div",null,r.a.createElement("button",{onClick:e,name:"google"},"Continue with Google"),r.a.createElement("button",{onClick:e,name:"github"},"Continue with Github")))},w=n(24),j=(n(39),function(e){var t=e.nweetObj,n=e.isOwner,c=Object(a.useState)(!1),u=Object(o.a)(c,2),i=u[0],l=u[1],s=Object(a.useState)(t.text),p=Object(o.a)(s,2),f=p[0],h=p[1],v=function(){var e=Object(d.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.confirm("Are you sure you want to delete this nweet?")){e.next=7;break}return e.next=4,b.doc("nweets/".concat(t.id)).delete();case 4:if(""===t.attachmentUrl){e.next=7;break}return e.next=7,E.refFromURL(t.attachmentUrl).delete();case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),g=function(){l((function(e){return!e})),f!==t.text&&h(t.text)},w=function(){var e=Object(d.a)(m.a.mark((function e(n){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.next=3,b.doc("nweets/".concat(t.id)).update({text:f});case 3:l(!1);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",null,i?r.a.createElement(r.a.Fragment,null,r.a.createElement("form",{onSubmit:w},r.a.createElement("input",{type:"text",placeholder:"Edit your nweet",value:f,required:!0,onChange:function(e){var t=e.target.value;h(t)}}),r.a.createElement("input",{type:"submit",value:"Update Nweet"})),r.a.createElement("button",{onClick:g},"Cancel")):r.a.createElement("div",{className:"nweetContainer"},r.a.createElement("div",{className:"nweet-user-infos"},r.a.createElement("h5",{className:"nweet-user-name"},"name: ",t.displayName),t.photoUrl&&r.a.createElement("img",{src:t.photoUrl,className:"nweet-user-photo",alt:""})),r.a.createElement("div",{className:"nweet-infos"},t.attachmentUrl&&r.a.createElement("img",{className:"nweet-photo",src:t.attachmentUrl,alt:""}),r.a.createElement("h4",{className:"nweet-text"},"content: ",t.text),n&&r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:v},"Delete Nweet"),r.a.createElement("button",{onClick:g},"Edit Nweet")))))}),O=n(50),x=function(e){var t=e.userObj,n=Object(a.useState)(""),c=Object(o.a)(n,2),u=c[0],i=c[1],l=Object(a.useState)(""),s=Object(o.a)(l,2),p=s[0],f=s[1],h=function(){var e=Object(d.a)(m.a.mark((function e(n){var a,r,c,o;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),""!==u){e.next=3;break}return e.abrupt("return");case 3:if(n.preventDefault(),a="",""===p){e.next=13;break}return r=E.ref().child("".concat(t.uid,"/").concat(Object(O.a)())),e.next=9,r.putString(p,"data_url");case 9:return c=e.sent,e.next=12,c.ref.getDownloadURL();case 12:a=e.sent;case 13:return o={text:u,createdAt:Date.now(),creatorId:t.uid,attachmentUrl:a},e.next=16,b.collection("nweets").add(o);case 16:i(""),f("");case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("form",{onSubmit:h},r.a.createElement("input",{className:"nweetInputText",value:u,onChange:function(e){var t=e.target.value;i(t)},type:"text",placeholder:"What's on your mind???",maxLength:120}),r.a.createElement("input",{type:"file",accept:"image/*",onChange:function(e){var t=e.target.files[0],n=new FileReader;n.onloadend=function(e){var t=e.currentTarget.result;f(t)},n.readAsDataURL(t)}}),r.a.createElement("input",{type:"submit",value:"Nweet"}),p&&r.a.createElement("div",null,r.a.createElement("img",{src:p,width:"50px",height:"50px",alt:""}),r.a.createElement("button",{onClick:function(){return f("")}},"Clear")))},y=(n(40),function(){var e=Object(d.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.signOut();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()),k=function(e){var t=e.userObj,n=Object(a.useState)([]),c=Object(o.a)(n,2),u=c[0],i=c[1];return Object(a.useEffect)((function(){var e;b.collection("userInfos").onSnapshot((function(t){e=t.docs.map((function(e){return Object(w.a)({},e.data())}))})),b.collection("nweets").onSnapshot((function(t){for(var n=t.docs.map((function(e){return Object(w.a)({id:e.id},e.data())})),a=0;a<n.length;a++)for(var r=0;r<e.length;r++)n[a].creatorId===e[r].uid&&(n[a].displayName=e[r].displayName,n[a].photoUrl=e[r].photoUrl);n.sort((function(e,t){return parseInt(t.createdAt)-parseInt(e.createdAt)})),i(n)}))}),[]),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"logoutAndNweetForm"},r.a.createElement("button",{onClick:function(){return y()}},"Log Out"),r.a.createElement(x,{userObj:t})),r.a.createElement("div",{className:"nweetsContainer"},u.map((function(e){return r.a.createElement(j,{key:e.id,nweetObj:e,isOwner:e.creatorId===t.uid})}))))},N=function(e){var t=e.userObj,n=e.setPhotoInfo,c=Object(a.useState)(""),u=Object(o.a)(c,2),i=u[0],l=u[1],s=function(){var e=Object(d.a)(m.a.mark((function e(a){var r,c,u,o,s;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.preventDefault(),r="",""===i){e.next=10;break}return c=E.ref().child("userProfilePhotos/".concat(Object(O.a)())),e.next=6,c.putString(i,"data_url");case 6:return u=e.sent,e.next=9,u.ref.getDownloadURL();case 9:r=e.sent;case 10:return e.next=12,b.collection("userInfos").get();case 12:return e.sent.docs.forEach((function(e){t.uid===e.data().uid&&(o=e.id)})),e.next=16,b.doc("userInfos/".concat(o)).update({photoUrl:r});case 16:s={docId:o,photoUrl:r},l(""),n(s);case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("form",{onSubmit:s},r.a.createElement("input",{type:"file",accept:"image/*",onChange:function(e){var t=e.target.files[0],n=new FileReader;n.onloadend=function(e){var t=e.currentTarget.result;l(t)},n.readAsDataURL(t)}}),i&&r.a.createElement(r.a.Fragment,null,r.a.createElement("img",{src:i,width:"50px",height:"50px",alt:""}),r.a.createElement("button",{onClick:function(){return l("")}},"Clear")),r.a.createElement("input",{type:"submit",value:"Add Photo"}))},I=(n(41),function(e){var t=e.refreshUser,n=e.userObj,c=Object(l.f)(),u=Object(a.useState)(n.displayName),i=Object(o.a)(u,2),s=i[0],p=i[1],f=Object(a.useState)({}),v=Object(o.a)(f,2),g=v[0],w=v[1],j=Object(a.useState)(!1),O=Object(o.a)(j,2),x=O[0],y=O[1];Object(a.useEffect)((function(){b.collection("userInfos").onSnapshot((function(e){e.docs.forEach((function(e){if(n.uid===e.data().uid){var t={docId:e.id,photoUrl:e.data().photoUrl};w(t)}}))})),y(!0)}),[n]);var k=function(){var e=Object(d.a)(m.a.mark((function e(a){var r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.preventDefault(),n.displayName===s){e.next=11;break}return e.next=4,n.updateProfile({displayName:s});case 4:return e.next=6,b.collection("userInfos").get();case 6:return e.sent.docs.forEach((function(e){n.uid===e.data().uid&&(r=e.id)})),e.next=10,b.doc("userInfos/".concat(r)).update({displayName:s});case 10:t();case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),I=function(){var e=Object(d.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.confirm("Are you sure you want to delete this photo?")){e.next=7;break}return e.next=4,b.doc("userInfos/".concat(g.docId)).update({photoUrl:""});case 4:return e.next=6,E.refFromURL(g.photoUrl).delete();case 6:w({});case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:function(){return h.signOut(),void c.push("/")}},"Log Out"),r.a.createElement("form",{onSubmit:k},r.a.createElement("input",{className:"profileNameText",onChange:function(e){var t=e.target.value;p(t)},type:"text",placeholder:"Display name",value:s}),r.a.createElement("input",{type:"submit",value:"Update Profile"})),r.a.createElement(r.a.Fragment,null,x&&g.photoUrl?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,r.a.createElement("img",{src:g.photoUrl,alt:"",className:"profile-photo"})),r.a.createElement("div",null,r.a.createElement("button",{onClick:function(){return I()}},"Delete Photo"))):r.a.createElement(N,{userObj:n,setPhotoInfo:w})))}),U=(n(46),function(e){var t=e.userObj;return r.a.createElement("nav",null,r.a.createElement("div",{className:"menuContainer"},r.a.createElement("div",{className:"homeContainer"},r.a.createElement(i.b,{to:"/",replace:!0},"Home")),r.a.createElement("div",{className:"profileContainer"},r.a.createElement(i.b,{to:"/profile",replace:!0},t.displayName,"\uc758 Profile"))))}),C=function(e){var t=e.refreshUser,n=e.isLoggedIn,a=e.userObj;return r.a.createElement(i.a,null,n&&r.a.createElement(U,{userObj:a}),r.a.createElement(l.c,null,n?r.a.createElement(r.a.Fragment,null,r.a.createElement(l.a,{exact:!0,path:"/"},r.a.createElement(k,{userObj:a})),r.a.createElement(l.a,{exact:!0,path:"/profile"},r.a.createElement(I,{userObj:a,refreshUser:t}))):r.a.createElement(r.a.Fragment,null,r.a.createElement(l.a,{exact:!0,path:"/"},r.a.createElement(g,null)))))};var S=function(){var e=Object(a.useState)(!1),t=Object(o.a)(e,2),n=t[0],c=t[1],u=Object(a.useState)(null),i=Object(o.a)(u,2),l=i[0],s=i[1];return Object(a.useEffect)((function(){h.onAuthStateChanged((function(e){s(e?{displayName:e.displayName,uid:e.uid,updateProfile:function(t){return e.updateProfile(t)}}:null),c(!0)}))}),[]),r.a.createElement(r.a.Fragment,null,n?r.a.createElement(C,{refreshUser:function(){var e=h.currentUser;s({displayName:e.displayName,uid:e.uid,updateProfile:function(t){return e.updateProfile(t)}})},isLoggedIn:Boolean(l),userObj:l}):"Initializing...!!")};u.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(S,null)),document.getElementById("root"))}},[[47,1,2]]]);
//# sourceMappingURL=main.15fe69ee.chunk.js.map